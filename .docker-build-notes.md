# Docker Build Notes

## Expected Image Size

Based on the optimized multi-stage Dockerfile:
- **Target Size**: < 200MB
- **Expected Range**: 150-180MB

## Optimization Techniques Applied

1. **Multi-stage build**: Separates build and runtime environments
2. **Alpine Linux base**: Minimal OS footprint (~50MB)
3. **Production dependencies only**: DevDependencies excluded from runtime
4. **node-prune**: Removes unnecessary files from node_modules (docs, tests, etc.)
5. **Layer caching**: Optimized layer ordering for faster rebuilds

## Build Verification

After building, verify the image size:

```bash
docker build -t mcp-fetch-node:latest .
docker images mcp-fetch-node:latest
```

Expected output:
```
REPOSITORY       TAG       IMAGE ID       CREATED         SIZE
mcp-fetch-node   latest    <image_id>     X minutes ago   ~150-180MB
```

## Size Breakdown (Approximate)

- Base node:22-alpine image: ~50MB
- Production node_modules: ~80-100MB
- Compiled application (dist/): ~5-10MB
- Runtime overhead: ~10-20MB
- **Total**: ~150-180MB

## Further Optimization (If Needed)

If the image exceeds 200MB:

1. Review dependencies for unused packages
2. Consider using distroless base image
3. Disable source maps in production build
4. Use `npm prune --production` or equivalent
5. Manually remove large unnecessary files

## Known Issues

- Network issues during build may cause timeouts when fetching pnpm or packages
- Solution: Retry the build or check network connectivity
- The Docker build caches layers, so subsequent builds are faster
